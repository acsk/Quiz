<div class="container mx-auto p-4">
  <!-- <h1 class="text-2xl font-bold mb-4">Perguntas</h1> -->
  <div class="mb-4">
    <label for="topicSelect" class="block text-sm font-medium text-gray-700">Selecione o Tópico:</label>
    <select id="topicSelect" [(ngModel)]="selectedTopicId" (change)="filterQuestionsByTopic()" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md">
      <option [ngValue]="null">Todos os Tópicos ({{ allQuestions.length }})</option>
      <option *ngFor="let topic of topics" [ngValue]="topic.id">{{ topic.name }} ({{ questionCounts[topic.id] || 0 }})</option>
    </select>
  </div>
  <div *ngIf="currentQuestion" class="mb-6 p-4 border rounded shadow">
    <div class="flex justify-between items-center mb-2">
      <h2 class="text-xl font-semibold">{{ currentQuestionIndex + 1 }}. {{ currentQuestion.question }}</h2>
      <span class="bg-blue-500 text-white text-sm font-semibold px-2 py-1 rounded">{{ currentQuestion.topicName }}</span>
    </div>
    <ul class="list-none pl-0">
      <li *ngFor="let option of currentQuestion.options" class="mb-1 flex items-center p-2 rounded"
          [ngClass]="{
            'bg-green-200': selectedOptions[currentQuestion.id] === option.index && showAnswer && option.index === currentQuestion.answer,
            'bg-red-200': selectedOptions[currentQuestion.id] === option.index && showAnswer && option.index !== currentQuestion.answer,
            'bg-gray-100': !showAnswer,
            'bg-green-100': showAnswer && option.index === currentQuestion.answer && selectedOptions[currentQuestion.id] !== option.index
          }">
        <input type="radio" [name]="'question-' + currentQuestion.id" [value]="option.index" class="mr-2"
               (change)="selectOption(option.index)" [checked]="selectedOptions[currentQuestion.id] === option.index">
        {{ option.index }}. {{ option.text }}
      </li>
    </ul>
    <div class="mt-4 flex justify-between">
      <button (click)="checkAnswer()" [disabled]="selectedOption === null" class="px-4 py-2 bg-blue-500 text-white rounded" [ngClass]="{'opacity-50': selectedOption === null}">
        <i class="fas fa-check mr-2"></i>Responder
      </button>
      <div class="flex space-x-2">
        <button (click)="previousQuestion()" [disabled]="currentQuestionIndex === 0" class="px-4 py-2 bg-gray-500 text-white rounded" [ngClass]="{'opacity-50': currentQuestionIndex === 0}">
          <i class="fas fa-arrow-left mr-2"></i>Voltar
        </button>
        <button (click)="nextQuestion()" class="px-4 py-2 bg-yellow-500 text-white rounded">
          Responder Depois
        </button>
        <button (click)="nextQuestion()" [disabled]="currentQuestionIndex >= filteredQuestions.length - 1" class="px-4 py-2 bg-green-500 text-white rounded" [ngClass]="{'opacity-50': currentQuestionIndex >= filteredQuestions.length - 1}">
          Próxima<i class="fas fa-arrow-right ml-2"></i>
        </button>
      </div>
     
    </div>
  </div> 
</div>